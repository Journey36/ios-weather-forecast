# ë‚ ì”¨ ì •ë³´

>   í˜„ì¬ ë‚ ì”¨ì™€ 5ì¼ ì¼ê¸° ì˜ˆë³´ë¥¼ ì•Œë ¤ì£¼ëŠ” ì•±

<img width="260" alt="ì‹œì—°" src="https://user-images.githubusercontent.com/73573732/138604330-5247f6cf-af69-4d4a-8f3f-7569f2870666.gif"> <img width="260" alt="ì‹œì—°2" src="https://user-images.githubusercontent.com/73573732/138615713-1f7cdec1-1127-4e44-98d6-da3e109cf969.gif"> <img width="260" alt="ì‹œì—°3" src="https://user-images.githubusercontent.com/73573732/138723024-eb9260e3-cf3f-4702-9a2f-345e86bf7fcf.gif">

<br/>



## ëª©ì°¨

-   [í”„ë¡œì íŠ¸ ì •ë³´](#í”„ë¡œì íŠ¸-ì •ë³´)
-   [ê¸°ëŠ¥ ë° íŠ¸ëŸ¬ë¸” ìŠˆíŒ…](#ê¸°ëŠ¥-ë°-íŠ¸ëŸ¬ë¸”-ìŠˆíŒ…)
    -   [í…Œì´ë¸” ë·° ë° ì…€ êµ¬í˜„](#í…Œì´ë¸”-ë·°-ë°-ì…€-êµ¬í˜„)
        -   [ê³ ë¯¼ ë˜ëŠ” ë¬¸ì œì ](#ê³ ë¯¼-ë˜ëŠ”-ë¬¸ì œì )
    -   [ë„¤íŠ¸ì›Œí¬ë¥¼ í†µí•œ ë°ì´í„° ë¡œë“œ](#ë„¤íŠ¸ì›Œí¬ë¥¼-í†µí•œ-ë°ì´í„°-ë¡œë“œ)
        -   [ê³ ë¯¼ ë˜ëŠ” ë¬¸ì œì ](#ê³ ë¯¼-ë˜ëŠ”-ë¬¸ì œì -2)
    -   [ìœ„ì¹˜ ì„œë¹„ìŠ¤ ê¶Œí•œ ì„¤ì •](#ìœ„ì¹˜-ì„œë¹„ìŠ¤-ê¶Œí•œ-ì„¤ì •)
        -   [ê³ ë¯¼ ë˜ëŠ” ë¬¸ì œì ](#ê³ ë¯¼-ë˜ëŠ”-ë¬¸ì œì -3)
    -   [ë¦¬í”„ë ˆì‹œ ì»¨íŠ¸ë¡¤ êµ¬í˜„](#ë¦¬í”„ë ˆì‹œ-ì»¨íŠ¸ë¡¤-êµ¬í˜„)
        -   [ê³ ë¯¼ ë˜ëŠ” ë¬¸ì œì ](#ê³ ë¯¼-ë˜ëŠ”-ë¬¸ì œì -4)
    -   [ì ‘ê·¼ì„± êµ¬í˜„](#ì ‘ê·¼ì„±-êµ¬í˜„)
        -   [ê³ ë¯¼ ë˜ëŠ” ë¬¸ì œì ](#ê³ ë¯¼-ë˜ëŠ”-ë¬¸ì œì -5)

</br>



## í”„ë¡œì íŠ¸ ì •ë³´

-   ì½”ë“œ ë¦¬ë·°ì–´: [delmaSong](https://github.com/delmaSong)
-   í•™ìŠµ í‚¤ì›Œë“œ: `URLSession`, `CoreLocation`, `UIRefreshControl`, `UITraitCollection`

<br/>



## ê¸°ëŠ¥ ë° íŠ¸ëŸ¬ë¸” ìŠˆíŒ…

### í…Œì´ë¸” ë·° ë° ì…€ êµ¬í˜„

|                             êµ¬ì¡°                             |
| :----------------------------------------------------------: |
| <img width="400" alt="í…Œì´ë¸”ë·° êµ¬ì¡°" src="https://user-images.githubusercontent.com/73573732/138659278-a6d1d3dc-849d-4a79-ab44-010bcb8be386.png"> |

`CurrentWeatherCell`ì€ í˜„ì¬ ë‚ ì”¨ ë° ì˜¨ë„, ìµœê³  ë° ìµœì € ì˜¨ë„ë¥¼ ë‚˜íƒ€ë‚´ê³ , `ForecastListCell`ì€ í˜„ì¬ë¶€í„° 5ì¼ ë™ì•ˆì˜ ì¼ê¸° ì˜ˆë³´(ì˜¨ë„ ë° ë‚ ì”¨)ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.

<br/>



### ê³ ë¯¼ ë˜ëŠ” ë¬¸ì œì 

|                       ê³ ë¯¼                        |
| :-----------------------------------------------: |
| ì•±ì˜ ë·°ë¥¼ êµ¬ì„±í•  ë•Œ, ì–´ë–¤ ë°©ì‹ìœ¼ë¡œ êµ¬í˜„í•´ì•¼ í• ê¹Œ? |

í…Œì´ë¸” ë·°ë¥¼ êµ¬í˜„í•  ë•Œ, ë” ë§ì€ ë°©ë²•ì´ ìˆì„ ìˆ˜ ìˆì§€ë§Œ, ì œê°€ ìƒê°í•œ ë°©ë²•ì€ 

1.   í…Œì´ë¸”ë·° í—¤ë”ë¡œ ë·°ë¥¼ ë¶„ë¦¬í•˜ì—¬ êµ¬í˜„
2.   í•˜ë‚˜ì˜ í…Œì´ë¸” ë·°ì˜ ì„¹ì…˜ì„ ë‚˜ëˆ„ì–´ êµ¬í˜„

ì´ë ‡ê²Œ ë‘ ê°€ì§€ê°€ ìˆì—ˆìŠµë‹ˆë‹¤. ì²« ë²ˆì§¸ ë°©ë²•ì€ í—¤ë” ë·°ê°€ ê°€ì§€ëŠ” ì›ë˜ì˜ ì˜ë¯¸ì¸, **í•´ë‹¹ ì„¹ì…˜ì— ëŒ€í•œ ì¶”ê°€ ì •ë³´ë¥¼ í‘œì‹œí•˜ëŠ” ë·°**ì™€ëŠ” ë‹¤ë¥´ê²Œ ì‚¬ìš©í•˜ëŠ” ê²ƒ ê°™ì•„ì„œ ë‘ ë²ˆì§¸ ë°©ë²•ì„ íƒí–ˆìŠµë‹ˆë‹¤. ì½”ë“œëŠ” ë‹¤ë¥¸ ì‚¬ëŒì´ ì½ê¸° ì‰¬ì›Œì•¼í•œë‹¤ê³  í•©ë‹ˆë‹¤. ê·¸ë ‡ë‹¤ë©´ ê·¸ ì‹œì‘ì€ ì„¤ê³„ìê°€ ì˜ë„í•œëŒ€ë¡œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ë” ì ì ˆí•˜ë‹¤ê³  ìƒê°í–ˆìŠµë‹ˆë‹¤.

<br/>



|                     ë¬¸ì œ                     |
| :------------------------------------------: |
| ë‹¤ë¥¸ ë‘ ì…€ì˜ êµ¬ë¶„ì„ ì„ ì–´ë–»ê²Œ ìˆ¨ê¸¸ ìˆ˜ ìˆì„ê¹Œ? |

í…Œì´ë¸” ë·° ì „ì²´ì˜ separator ìŠ¤íƒ€ì¼ì€ `separatorStyle = .none` ìœ¼ë¡œ ì‰½ê²Œ ì ìš©í•  ìˆ˜ ìˆì§€ë§Œ, ë‘ ê°œì˜ ë‹¤ë¥¸ ì…€ ì‚¬ì´ì˜ í•˜ë‚˜ì˜ êµ¬ë¶„ì„ (separator)ë§Œ ì—†ì• ë ¤ë©´ í•´ë‹¹ ë°©ë²•ìœ¼ë¡œëŠ” ë¶ˆê°€ëŠ¥í–ˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ì•½ê°„ì˜ í¸ë²•ìœ¼ë¡œ í•´ë‹¹ `separatorInset`ì„ í™”ë©´ ë°–ìœ¼ë¡œ ë°€ì–´ë‚´ëŠ” ë°©ë²•ì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.

```swift
separatorInset.left = .greatestFiniteMagnitude // ìœ í•œí•œ ê°’ ì¤‘ ê°€ì¥ í° ê°’
```

<br/>



|                        ë¬¸ì œ                        |
| :------------------------------------------------: |
| í…Œì´ë¸” ë·°ì— ë°°ê²½í™”ë©´ì„ ì ìš©í•˜ë ¤ë©´ ì–´ë–»ê²Œ í•´ì•¼í• ê¹Œ? |

`UITableView`ì—ëŠ” `backgroundView`ë¼ëŠ” ì†ì„±ì´ ìˆì–´ì„œ í•´ë‹¹ ì†ì„±ì— ì´ë¯¸ì§€ ë¦¬í„°ëŸ´ì„ ë„£ì–´ì¤¬ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì…€ì´ ë¡œë“œë˜ë©´ì„œ í•´ë‹¹ ë°°ê²½ì„ ë‹¤ ê°€ë ¤ë²„ë¦¬ëŠ” ë¬¸ì œê°€ ìˆì—ˆìŠµë‹ˆë‹¤.

<img width="300" alt="í…Œì´ë¸” ë·° ë°°ê²½ ì´ë¯¸ì§€ ì´ìŠˆ" src="https://user-images.githubusercontent.com/73573732/138690307-8655fa3c-65ae-48a2-9f72-a91ae3446ee8.gif">

í•´ë‹¹ ë¬¸ì œëŠ” ì…€ `contentView`ì˜ ê¸°ë³¸ ë°°ê²½ ìƒ‰ìƒì´ ì›ì¸ì¸ ê²ƒ ê°™ì•„ì„œ ìƒ‰ìƒì„ `clear`ë¡œ ì„¤ì •í•´ì£¼ë‹ˆ ì •ìƒì ìœ¼ë¡œ ë™ì‘í–ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ê° ì…€ë§ˆë‹¤ ì„¤ì •í•´ì¤˜ì•¼ í•˜ëŠ”, í™•ì¥ì„±ì´ ë–¨ì–´ì§„ë‹¤ê³  ìƒê°í–ˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ì…€ì´ ê·¸ë ¤ì§€ê¸° ì§ì „ì— í˜¸ì¶œë˜ëŠ” `tableView(_:willDisplay:forRowAt:)`ì— í•´ë‹¹ ì†ì„±ì„ ì§€ì •í•´ì£¼ëŠ” ê²ƒì´ ì¢‹ê² ë‹¤ê³  íŒë‹¨í–ˆìŠµë‹ˆë‹¤.

```swift
// Delegate Methods
func tableView(_ tableView: UITableView, willDisplay cell: UITableViewCell, forRowAtIndexPath: IndexPath) {
    cell.backgroundColor = .clear
}
```

[ğŸ‘† ëª©ì°¨ë¡œ ëŒì•„ê°€ê¸°](#ëª©ì°¨)

<br/>



## ë„¤íŠ¸ì›Œí¬ë¥¼ í†µí•œ ë°ì´í„° ë¡œë“œ

|      ê°ì²´      |                             ì„¤ëª…                             |
| :------------: | :----------------------------------------------------------: |
| **URLManager** | API URLì„ ë§Œë“¤ê¸° ìœ„í•œ ê°ì²´ì…ë‹ˆë‹¤. `URLComponents`ë¥¼ í†µí•´ `URLQueryItem`ì„ ì¡°í•©í•´ì„œ ìƒì„±í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤. |

```swift
enum URLManager {
    private static let baseAPIURL: String = "http://api.openweathermap.org/data/2.5/"
    private static let baseIconURL: String = "https://openweathermap.org/img/wn/"
    private static let appID = Bundle.main.infoDictionary?["API_KEY"] as? String
    private static let units: String = "metric"
    
    static func setURL(_ coordinates: CurrentLocation, with type: ForecastType) throws -> URL? {
        guard let unwrappedAppID: String = appID else {
            throw ErrorTransactor.networkError(.invalidURL)
        }
        
        var components: URLComponents? = .init(string: baseAPIURL)
        components?.path += type.rawValue
        
        let latitude: URLQueryItem = .init(name: "lat", value: coordinates.latitude)
        let longitude: URLQueryItem = .init(name: "lon", value: coordinates.longitude)
        let units: URLQueryItem = .init(name: "units", value: units)
        let appID: URLQueryItem = .init(name: "appid", value: unwrappedAppID)
        components?.queryItems = [latitude, longitude, units, appID]
        return components?.url
    }

    static func setImageURL(of imageID: String) throws -> URL? {
        var components: URLComponents? = .init(string: baseIconURL)
        components?.path += "\(imageID)@2x.png"

        return components?.url
    }
}

```

| ê°ì²´                | ì„¤ëª…                                                         |
| ------------------- | ------------------------------------------------------------ |
| **DataTaskManager** | URLManager íƒ€ì…ì„ í™œìš©í•´ URLì„ ë§Œë“¤ê³ , í•˜ë‚˜ì˜ ì„¸ì…˜ ìƒì„± í›„, ì´ë¯¸ì§€ë¥¼ ë°›ì•„ì˜¤ëŠ” ì‘ì—…(task)ì™€ ë‚˜ë¨¸ì§€ ë°ì´í„°ë¥¼ ë°›ì•„ì˜¤ëŠ” ì‘ì—…ì„ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤. ë°ì´í„°ë¥¼ ë°›ì•„ì˜¤ëŠ” ì‘ì—…ì€ ë‘ ê°œì˜ ë‹¤ë¥¸ ì…€ì„ í•˜ë‚˜ì˜ íƒœìŠ¤í¬ë¡œ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ì œë„¤ë¦­ íƒ€ì…ì„ ì‚¬ìš©í•´ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤. `Result` íƒ€ì…ì„ ì´ìš©í•´ ì„±ê³µê³¼ ì‹¤íŒ¨ë¥¼ ë¶„ê¸°í•˜ì—¬ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤. |

```swift
func fetchWeatherData<T: Decodable>(on coordinates: CurrentLocation, type: ForecastType, completion: @escaping (Result<T, ErrorTransactor>) -> Void) {
	guard let apiURL: URL = try? URLManager.setURL(coordinates, with: type) else {
		return
	}
        
	session.dataTask(with: apiURL) { (data: Data?, response: URLResponse?, error: Error?) in
		if let _: Error = error {
			completion(.failure(ErrorTransactor.networkError(.invalidURL)))
		}
            
		guard let response: HTTPURLResponse = response as? HTTPURLResponse, (200...299).contains(response.statusCode) else {
			return completion(.failure(ErrorTransactor.networkError(.unexpactableResponse)))
		}
            
		guard let data: Data = data else {
			return completion(.failure(ErrorTransactor.networkError(.dataFetchingFailure)))
		}
            
		do {
			let decoder: JSONDecoder = .init()
			let weatherData: T = try decoder.decode(T.self, from: data)
			completion(.success(weatherData))
		} catch {
			completion(.failure(.networkError(.dataFetchingFailure)))
		}
            
	}.resume()
}
```

<br/>



### ê³ ë¯¼ ë˜ëŠ” ë¬¸ì œì 

|                             ê³ ë¯¼                             |
| :----------------------------------------------------------: |
| ë™ì¼í•œ êµ¬ì¡°ì˜ ë°ì´í„° ì²˜ë¦¬ ì½”ë“œë¥¼ ì–´ë–»ê²Œ í•˜ë‚˜ë¡œ í•©ì¹  ìˆ˜ ìˆì„ê¹Œ? |

í˜„ì¬ ë‚ ì”¨ë¥¼ ë³´ì—¬ì£¼ëŠ” CurrentWeatherCellê³¼ 5ì¼ ì˜ˆë³´ë¥¼ ë³´ì—¬ì£¼ëŠ” ForecastListCellì€ ë³´ì—¬ì£¼ëŠ” ë°ì´í„°ë§Œ ë‹¤ë¥¼ ë¿, ë°›ì•„ì˜¤ëŠ” ë°©ë²•ì´ ê°™ìŠµë‹ˆë‹¤. ì´ ê²ƒì„ ë‹¤ë¥¸ í•¨ìˆ˜ë¡œ, ë˜ëŠ” ë‹¤ë¥¸ íƒœìŠ¤í¬ë¡œ ë§Œë“¤ê¸°ì—ëŠ” ë‚­ë¹„ë¼ê³  ìƒê°í–ˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ì œë„¤ë¦­ì„ ì‚¬ìš©í•´ì„œ í•˜ë‚˜ì˜ í•¨ìˆ˜ì—ì„œ ë‘ ê°œì˜ ì‘ì—…ì„ í•œ ë²ˆì— ì²˜ë¦¬í•  ìˆ˜ ìˆë„ë¡ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.

```swift
private let session: URLSession = .shared

func fetchWeatherData<T: Decodable>(on coordinates: CurrentLocation, type: ForecastType, completion: @escaping (Result<T, ErrorTransactor>) -> Void) {
        guard let apiURL: URL = try? URLManager.setURL(coordinates, with: type) else {
            return
        }
        
        session.dataTask(with: apiURL) { (data: Data?, response: URLResponse?, error: Error?) in
            if let _: Error = error {
                completion(.failure(ErrorTransactor.networkError(.invalidURL)))
            }
            
            guard let response: HTTPURLResponse = response as? HTTPURLResponse, (200...299).contains(response.statusCode) else {
                return completion(.failure(ErrorTransactor.networkError(.unexpactableResponse)))
            }
            
            guard let data: Data = data else {
                return completion(.failure(ErrorTransactor.networkError(.dataFetchingFailure)))
            }
            
            do {
                let decoder: JSONDecoder = .init()
                let weatherData: T = try decoder.decode(T.self, from: data)
                completion(.success(weatherData))
            } catch {
                completion(.failure(.networkError(.dataFetchingFailure)))
            }
            
        }.resume()
    }

```

<br/>



|                          ë¬¸ì œ                           |
| :-----------------------------------------------------: |
| API Keyë¥¼ ë³€ìˆ˜ê°€ ì•„ë‹Œ ë‹¤ë¥¸ ë°©ë²•ìœ¼ë¡œ ê´€ë¦¬í•  ìˆ˜ëŠ” ì—†ì„ê¹Œ? |

**Info.plist**ì˜ í™˜ê²½ ë³€ìˆ˜ë¡œ APIí‚¤ë¥¼ ì‘ì„±í•˜ê³  ì½”ë“œì—ì„œ í•´ë‹¹ í™˜ê²½ ë³€ìˆ˜ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë°©ë²•ìœ¼ë¡œ ì²˜ë¦¬í–ˆìŠµë‹ˆë‹¤.

(í•´ë‹¹ ë°©ë²•ì„ ì‚¬ìš©í•˜ë©´ **Info.plist** ë° ***.xcconfig**ë¥¼ ì†ŒìŠ¤ì½”ë“œì— ì˜¬ë¦¬ë©´ ì•„ë¬´ ì†Œìš© ì—†ì§€ë§Œ, í‚¤ê°€ ë…¸ì¶œë˜ì–´ë„ í¬ë¦¬í‹°ì»¬í•œ ì´ìŠˆê°€ ì•„ë‹ˆê¸° ë•Œë¬¸ì— í™•ì¸ìš©ìœ¼ë¡œ Githubì— ì—…ë¡œë“œ í–ˆìŠµë‹ˆë‹¤.)

**[API Keyë¥¼ ìˆ¨ê¸°ëŠ” ë°©ë²• ì •ë¦¬](https://github.com/Journey36/TIL/blob/main/Xcode/HowToHideAPIKey.md)**

[ğŸ‘† ëª©ì°¨ë¡œ ëŒì•„ê°€ê¸°](#ëª©ì°¨)

<br/>



## ìœ„ì¹˜ ì„œë¹„ìŠ¤ ê¶Œí•œ ì„¤ì •

|           ì•±ì„ ì‚¬ìš©í•˜ëŠ” ë™ì•ˆ í—ˆìš©(ë˜ëŠ” í•œ ë²ˆ í—ˆìš©)           |                          í—ˆìš© ì•ˆí•¨                           |
| :----------------------------------------------------------: | :----------------------------------------------------------: |
| <img width="300" alt="ê¶Œí•œ ìŠ¹ì¸í•œ ê²½ìš°" src="https://user-images.githubusercontent.com/73573732/138706845-584d6f7d-a6a7-478f-b9c5-d9b9c5d29004.gif"> | <img width="300" alt="ê¶Œí•œ ê±°ë¶€í–ˆì„ ê²½ìš°" src="https://user-images.githubusercontent.com/73573732/138706817-0f59dfe9-87d5-40ea-954d-4af41ca4e312.gif"> |

ìœ„ì¹˜ ì„œë¹„ìŠ¤ ê¶Œí•œì„ í—ˆìš©í•˜ëŠ” ê²½ìš° API Keyë¥¼ í† ëŒ€ë¡œ í˜„ì¬ ìœ„ì¹˜ì˜ ë°ì´í„°ë¥¼ ê°€ì§€ê³  ì˜µë‹ˆë‹¤. ë§Œì•½ ìœ„ì¹˜ ì„œë¹„ìŠ¤ ê¶Œí•œì„ ìŠ¹ì¸í•˜ì§€ ì•ŠëŠ” ê²½ìš°ëŠ” ì‚¬ìš©ìê°€ ìœ„ì¹˜ ì„œë¹„ìŠ¤ ê¶Œí•œì„ ìŠ¹ì¸í•  ìˆ˜ ìˆë„ë¡ ì„¤ì • ì•±ìœ¼ë¡œ ìœ ë„í•©ë‹ˆë‹¤.

<br/>



### ê³ ë¯¼ ë˜ëŠ” ë¬¸ì œì 

|                             ë¬¸ì œ                             |
| :----------------------------------------------------------: |
| ì™œ `locationManager(_:didFailWithError:)`ê°€ ê¶Œí•œ ìŠ¹ì¸ì„ í•˜ê¸° ì „ì— í˜¸ì¶œë ê¹Œ? |
| <img width="500" alt="ê¶Œí•œ ìŠ¹ì¸ ì „ Fail" src="https://user-images.githubusercontent.com/73573732/138710632-ae5361ed-efd5-439c-8d2f-8db1cbfc4416.gif"> |

CLLocationManagerDelegateì—ì„œ ìœ„ì¹˜ ì •ë³´ê°€ ì—…ë°ì´íŠ¸ ë  ë•Œ í˜¸ì¶œë˜ëŠ” `locationManager(_:didUpdateLocations:)`ëŠ” í•­ìƒ `locationManager(_:didFailWithError:)`ì™€ í•¨ê»˜ êµ¬í˜„ë˜ì–´ì•¼ í•©ë‹ˆë‹¤. ì´ì „ ì½”ë“œì—ì„œëŠ” `viewDidLoad()`ì—ì„œ ìœ„ì¹˜ ì„œë¹„ìŠ¤ë¥¼ ìš”ì²­í–ˆê³ , ì¼ì • ì‹œê°„ì´ ì§€ë‚˜ë„ ê¶Œí•œì„ í—ˆìš©í•˜ì§€ ì•ŠëŠ” ìƒí™©ì„ ì¸ì§€í•˜ê³  `locationManager(_:didFailWithError:)`ê°€ í˜¸ì¶œëœ ê²ƒì…ë‹ˆë‹¤. í•´ë‹¹ ë©”ì„œë“œëŠ” CLError íƒ€ì…ì˜ ì—ëŸ¬ë¥¼ ì²˜ë¦¬í•˜ëŠ” ê²ƒìœ¼ë¡œ í™•ì¸í–ˆìœ¼ë©°, ê±°ë¶€ ì˜ì‚¬ë¥¼ í‘œì‹œí•˜ì§€ ì•Šê³  ë‹¤ë¥¸ ê¸°íƒ€ ë¬¸ì œê°€ ë°œìƒí–ˆì„ ë•ŒëŠ” ìœ„ì¹˜ ì„œë¹„ìŠ¤ ì—…ë°ì´íŠ¸ë¥¼ ì¤‘ì§€í•˜ëŠ” ì²˜ë¦¬ë¥¼ í–ˆìŠµë‹ˆë‹¤.

```swift
func locationManager(_ manager: CLLocationManager, didFailWithError error: Error) {
	switch error {
	case CLError.denied:
		presentAlert(.locationSevicesRefusal)
	default:
		manager.stopUpdatingLocation()
	}
}
```

ê·¸ë¦¬ê³  ê¶Œí•œì´ ë³€ê²½ë˜ì—ˆì„ ë•Œ í˜¸ì¶œë˜ëŠ” ë©”ì„œë“œì¸ `locationManager(_:didChangeAuthorization:)`ì—ì„œ ìƒíƒœì— ë”°ë¼ ë¶„ê¸°í•˜ë„ë¡  ì²˜ë¦¬í–ˆìŠµë‹ˆë‹¤. ë‹¤ë§Œ, í•´ë‹¹ ë©”ì„œë“œëŠ” **iOS 14.0**ë¶€í„° **deprecated** ëê¸°ì—, ìƒˆë¡œìš´ ë²„ì „ìœ¼ë¡œë„ í‘œê¸°í•´ì¤¬ìŠµë‹ˆë‹¤.

**[`@unknown default`ì— ëŒ€í•œ ì •ë¦¬](https://github.com/Journey36/TIL/blob/main/Swift/UnknownDefault.md)**

```swift
@available(iOS 14, *)
    func locationManagerDidChangeAuthorization(_ manager: CLLocationManager) {
        switch manager.authorizationStatus {
        case .authorizedAlways, .authorizedWhenInUse:
            manager.requestLocation()
        case .denied, .restricted:
            presentAlert(.locationSevicesRefusal)
            break
        case .notDetermined:
            break
        @unknown default:
            break
        }
    }
    
// MARK: - Deprecated in iOS 14.0
    func locationManager(_ manager: CLLocationManager, didChangeAuthorization status: CLAuthorizationStatus) {
        switch status {
        case .authorizedAlways, .authorizedWhenInUse:
            manager.requestLocation()
        case .denied, .restricted:
            presentAlert(.locationSevicesRefusal)
        case .notDetermined:
            break
        @unknown default:
            break
        }
    }
```

<br/>



|                        ê³ ë¯¼                         |
| :-------------------------------------------------: |
| ìœ„ì¹˜ ì •í™•ë„ì— ëŒ€í•œ ê°’ì€ ì–´ë–¤ ê²ƒì„ ì“°ëŠ” ê²ƒì´ ì¢‹ì„ê¹Œ? |

ìœ„ì¹˜ ë°ì´í„°ì˜ ì •í™•ë„ëŠ” ì‚¬ìš©ìê°€ ì•±ì„ ì‚¬ìš©í•˜ë©´ì„œ ëŠë¼ëŠ” ì‹ ë¢°ë„ì˜ í° ì˜í–¥ì„ ë¯¸ì¹œë‹¤ê³  ìƒê°í•©ë‹ˆë‹¤. ë§Œì•½ ì •ë§ ì •í™•í•œ ìœ„ì¹˜ ë°ì´í„°ë¥¼ ìš”êµ¬í•˜ëŠ” ì„œë¹„ìŠ¤ì—ì„œ ì ê²ŒëŠ” ìˆ˜ ë°± ë¯¸í„°ì—ì„œ ë§ê²ŒëŠ” í‚¤ë¡œë¯¸í„° ë‹¨ìœ„ì˜ ì˜¤ì°¨ê°€ ë‚œë‹¤ë©´, ì‚¬ìš©ìëŠ” í•´ë‹¹ ì•±ì— ëŒ€í•œ ì‹ ë¢°ë„ê°€ ë°”ë‹¥ì„ ì¹  ê²ƒì…ë‹ˆë‹¤. ê·¸ë ‡ë‹¤ê³  ë¬´ì‘ì • ë†’ì€ ìœ„ì¹˜ ì •í™•ë„ ê°’ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒë„ ê·¸ ë§Œí¼ ë§ì€ ì „ë ¥ì„ ìš”êµ¬í•˜ê¸° ë•Œë¬¸ì— ë¬´ë¦¬ê°€ ìˆìŠµë‹ˆë‹¤. ë‚ ì”¨ì˜ ê²½ìš°ëŠ” ë¹„êµì  ë¶€ì •í™•í•œ ìœ„ì¹˜ ë°ì´í„°ë¥¼ ì‚¬ìš©í•´ë„ ëœë‹¤ê³  ìƒê°í•©ë‹ˆë‹¤. ì •ë§ ê·¹ë‹¨ì ìœ¼ë¡œ ëª‡ ë°œìêµ­ ì˜†ì—ëŠ” ì†Œë‚˜ê¸°ê°€ ì˜¤ëŠ”ë°, ë‚´ê°€ ìˆëŠ” ê³³ì€ ë¹„ê°€ ì˜¤ì§€ ì•ŠëŠ” ê·¸ëŸ° ê²½ìš°ë¥¼ ì œì™¸í•˜ê³ ëŠ” ë‚ ì”¨ëŠ” ê´‘ë²”ìœ„ì— ê±¸ì³ì„œ ë‚˜íƒ€ë‚˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ê°€ì¥ ëŒ€ëµì ì¸ ê°’ì„ ì‚¬ìš©í•˜ëŠ” `kCLLocationAccuracyReduced`ëŠ” **iOS 14.0**ë¶€í„° ì§€ì›í•˜ê¸° ë•Œë¬¸ì— ì €ëŠ” `kCLLocationAccuracyThreeKilometers`ë¥¼ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.

**[Desired Accuracy Constants](https://github.com/Journey36/TIL/blob/main/iOS/Location/DesiredAccuracyConstants.md)ì— ëŒ€í•œ ì •ë¦¬**

[ğŸ‘† ëª©ì°¨ë¡œ ëŒì•„ê°€ê¸°](#ëª©ì°¨)

<br/>



## ë¦¬í”„ë ˆì‹œ ì»¨íŠ¸ë¡¤ êµ¬í˜„

|                     ìƒˆë¡œê³ ì¹¨(ê¶Œí•œ ìŠ¹ì¸)                      |                     ìƒˆë¡œê³ ì¹¨(ê¶Œí•œ ê±°ë¶€)                      |
| :----------------------------------------------------------: | :----------------------------------------------------------: |
| <img width="300" src="https://user-images.githubusercontent.com/73573732/138734992-8bc6982f-86ba-4280-8506-b48c700379a1.gif"> | <img width="300" src="https://user-images.githubusercontent.com/73573732/138734960-44a22140-60dd-46f5-9495-813d60fa25a5.gif"> |

`UIRefreshControl`ì„ ë™ì‘ì‹œí‚¤ë©´ ìœ„ì¹˜ ì •ë³´ë¥¼ ì—…ë°ì´íŠ¸í•¨ê³¼ ë™ì‹œì— `UITableView`ë¥¼ ë‹¤ì‹œ ë¡œë“œí•˜ë„ë¡ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.

<br/>



### ê³ ë¯¼ ë˜ëŠ” ë¬¸ì œì 

|                             ë¬¸ì œ                             |
| :----------------------------------------------------------: |
| ì–´ë–»ê²Œ ë°ì´í„° ë¡œë“œê°€ ì™„ë£Œë˜ëŠ” ì‹œì ì— ìƒˆë¡œê³ ì¹¨ì´ ëë‚˜ë„ë¡ êµ¬í˜„í• ê¹Œ? |

`UIRefreshControl`ì˜ íƒ€ê²Ÿì•¡ì…˜ìœ¼ë¡œ ì§€ì •ëœ í•¨ìˆ˜ì— ì—…ë°ì´íŠ¸ì™€ ì¢…ë£Œ ë¡œì§ì„ í•¨ê»˜ êµ¬í˜„í–ˆì—ˆìŠµë‹ˆë‹¤. ê·¸ë¬ì„ ë•Œ, ë¦¬í”„ë ˆì‹œ ì»¨íŠ¸ë¡¤ì˜ ì• ë‹ˆë©”ì´ì…˜ì´ ë¨¼ì € ì¢…ë£Œë˜ê³  ì—…ë°ì´íŠ¸ëŠ” ì´í›„ì— ë°œìƒí•˜ëŠ” ë¬¸ì œê°€ ìˆì—ˆìŠµë‹ˆë‹¤. ë¦¬ë¡œë“œê°€ ë¹ ë¥´ë‹¤ë©´ ë”±íˆ ë¬¸ì œì ì„ ëª» ëŠë‚„ ìˆ˜ ìˆì§€ë§Œ, ë„¤íŠ¸ì›Œí¬ ìƒíƒœ ë˜ëŠ” ì—¬ëŸ¬ê°€ì§€ ì›ì¸ì— ì˜í•´ì„œ ë¡œë”©ì´ ëŠë ¤ì§€ëŠ” ê²½ìš°ëŠ” í˜¼ë€ì„ ì¼ìœ¼í‚¬ ìˆ˜ ìˆë‹¤ê³  ìƒê°í–ˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ë°ì´í„° ë¡œë“œê°€ ì™„ë£Œë˜ëŠ” ì‹œì ì—

```swift
func finishRefreshing() {
	if forecastListView.refreshControl?.isRefreshing == true {
		manager.stopUpdatingLocation()
		DispatchQueue.main.async {
			self.refreshControl.endRefreshing()
		}
	}
}
```

í•´ë‹¹ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ í•´ê²°í–ˆìŠµë‹ˆë‹¤.

[ğŸ‘† ëª©ì°¨ë¡œ ëŒì•„ê°€ê¸°](#ëª©ì°¨)

<br/>



## ì ‘ê·¼ì„± êµ¬í˜„

|                   ë‹¤í¬ ëª¨ë“œ ë° ë³¼ë“œì²´ ì ìš©                   |                        ë‹¤ì´ë‚˜ë¯¹ íƒ€ì…                         |
| :----------------------------------------------------------: | :----------------------------------------------------------: |
| <img width="300" src="https://user-images.githubusercontent.com/73573732/138896860-6ee2388e-74cc-4e63-b0b4-12953a3f430d.gif"> | <img width="300" src="https://user-images.githubusercontent.com/73573732/138896521-c3843113-875a-4546-9c5a-4188dac6cbcd.gif"> |

ì €ì‹œë ¥ìë¥¼ ìœ„í•œ ë‹¤ì´ë‚˜ë¯¹ íƒ€ì…ì„ ê³ ë ¤í–ˆìŠµë‹ˆë‹¤. íŠ¹íˆ **'ë” í° í…ìŠ¤íŠ¸'** ì˜µì…˜ì„ ì‚¬ìš©í•  ê²½ìš° í…ìŠ¤íŠ¸ í¬ê¸°ë¥¼ ê¸°ì¡´ë³´ë‹¤ 5ë‹¨ê³„ ë” ì¦ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•´ë‹¹ ì˜µì…˜ì˜ í¬ê¸°ë¥¼ ì‚¬ìš©í–ˆì„ ë•Œ, ì‚¬ìš©ìì˜ ê°€ë…ì„±ì„ ìœ„í•´ ë ˆì´ì•„ì›ƒì´ ìë™ìœ¼ë¡œ ë³€ê²½ë˜ë„ë¡ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤. ì´ì— ë”°ë¼ ìë™ìœ¼ë¡œ ë³¼ë“œì²´ ì ìš© ì˜µì…˜ë„ ì„¤ì •ë©ë‹ˆë‹¤.

ë‹¤í¬ëª¨ë“œë¥¼ ì§€ì›í•˜ê¸° ìœ„í•´ ì´ë¯¸ì§€ë„ ë‘ ê°€ì§€ ë²„ì „ì„ ì§€ì›í•˜ë©°, `UILabel`ë„ ìë™ìœ¼ë¡œ ìƒ‰ìƒì— ë§ê²Œ ë³€ê²½ë˜ë„ë¡ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤. ë‹¤í¬ëª¨ë“œëŠ” **iOS 13.0**ë¶€í„° ì§€ì›í•˜ê¸° ë•Œë¬¸ì— `if #available`ì„ í†µí•´ ë¶„ê¸°ì²˜ë¦¬ í–ˆìŠµë‹ˆë‹¤

<br/>



### ê³ ë¯¼ ë˜ëŠ” ë¬¸ì œì 

|                             ë¬¸ì œ                             |
| :----------------------------------------------------------: |
| ë„¤íŠ¸ì›Œí¬ë¡œ ë°›ì•„ì˜¤ëŠ” ì´ë¯¸ì§€ëŠ” ì–´ë–»ê²Œ ë‹¤ì´ë‚˜ë¯¹ íƒ€ì…ìœ¼ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆì„ê¹Œ? |

ì´ë¯¸ì§€ ìì²´ë„ `adjustsImageSizeForAccessibilityContentSizeCategory` ì†ì„±ì„ `true`ë¡œ ì„¤ì • ë° ì˜¤í†  ë ˆì´ì•„ì›ƒì„ í†µí•´ ì´ë¯¸ì§€ í¬ê¸°ê°€ ìë™ìœ¼ë¡œ ì¡°ì ˆë˜ë„ë¡ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ë‚ ì”¨ APIì—ì„œ ë°›ì•„ì˜¤ëŠ” ì´ë¯¸ì§€ ì‚¬ì´ì¦ˆê°€ 100 x 100ì´ê¸° ë•Œë¬¸ì— ì…€ ë†’ì´ê°€ ë„ˆë¬´ ì»¤ì ¸ë²„ë¦¬ëŠ” ë¬¸ì œê°€ ìˆì—ˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ì´ë¯¸ì§€ ì‚¬ì´ì¦ˆë¥¼ `isAccessibilityCategory`ë¥¼ í†µí•´ ì‘ì€ ì‚¬ì´ì¦ˆì™€ í° ì‚¬ì´ì¦ˆë¡œ ë¶„ë¦¬í•˜ì—¬ ì²˜ë¦¬í–ˆìŠµë‹ˆë‹¤.

```swift
private let imageViewHeight: CGFloat = 30
private let imageViewHeightForA11y: CGFloat = 105
//...
generalConstraints = [
    weatherIconImageView.heightAnchor.constraint(equalToConstant: imageViewHeight),
    //...
]
accessibilityConstraints = [
    weatherIconImageView.heightAnchor.constraint(equalToConstant: 
                                                 imageViewHeightForA11y)
]
//...

private func updateLayoutConstraints() {
    //...
    if traitCollection.preferredContentSizeCategory.isAccessibilityCategory {
        NSLayoutConstraint.deactivate(generalConstraints)
        NSLayoutConstraint.activate(accessibilityConstraints)
    } else {
        NSLayoutConstraint.activate(generalConstraints)
        NSLayoutConstraint.deactivate(accessibilityConstraints)
    }
}

override func traitCollectionDidChange(_ previousTraitCollection: UITraitCollection?) {
    if traitCollection.preferredContentSizeCategory != previousTraitCollection?.preferredContentSizeCategory {
		updateLayoutConstraints()
	}
}
```

[ğŸ‘† ëª©ì°¨ë¡œ ëŒì•„ê°€ê¸°](#ëª©ì°¨)
